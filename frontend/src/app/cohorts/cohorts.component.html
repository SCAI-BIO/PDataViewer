<div class="main-container">
  <div class="description-box">
    <h1>Cohort Study Overview</h1>
    <p>
      The table below provides an overview of the cohort studies included in
      PDataViewer. It displays the number of recruited participants and key
      information on the respective study design as reported on the
      corresponding cohort study's reference link. Additionally, links are
      provided which facilitate access to the underlying datasets.
    </p>
  </div>

  <!-- Loading Spinner -->
  @if (loading) {
  <div class="loading-spinner">
    <mat-spinner diameter="40"></mat-spinner>
  </div>
  }

  <div class="mat-elevation-z8 table-container">
    <table mat-table [dataSource]="dataSource" matSort class="mat-table">
      <!-- Cohort Name Column -->
      <ng-container matColumnDef="cohort">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Cohorts</th>
        <td mat-cell *matCellDef="let element">
          <span
            class="color-circle"
            [style.background-color]="element.Color"
          ></span>
          <span class="cohort-name">{{ element.cohort }}</span>
        </td>
      </ng-container>

      <!-- Participants Column -->
      <ng-container matColumnDef="participants">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Participants</th>
        <td mat-cell *matCellDef="let element">{{ element.Participants }}</td>
      </ng-container>

      <!-- Healthy Controls Column -->
      <ng-container matColumnDef="healthyControls">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          Healthy Controls
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.HealthyControls }}
        </td>
      </ng-container>

      <!-- Prodromal Patients Column -->
      <ng-container matColumnDef="prodromalPatients">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          Prodromal Patients
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.ProdromalPatients }}
        </td>
      </ng-container>

      <!-- PD Patients Column -->
      <ng-container matColumnDef="pdPatients">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>PD Patients</th>
        <td mat-cell *matCellDef="let element">{{ element.PDPatients }}</td>
      </ng-container>

      <!-- Longitudinal Patients Column -->
      <ng-container matColumnDef="longitudinalPatients">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>â‰¥ 2 Visits</th>
        <td mat-cell *matCellDef="let element">
          {{ element.LongitudinalPatients }}
        </td>
      </ng-container>

      <!-- Follow Up Interval Column -->
      <ng-container matColumnDef="followUpInterval">
        <th mat-header-cell *matHeaderCellDef>Follow-up Interval</th>
        <td mat-cell *matCellDef="let element">
          {{ element.FollowUpInterval }}
        </td>
      </ng-container>

      <!-- Location Column -->
      <ng-container matColumnDef="location">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Location</th>
        <td mat-cell *matCellDef="let element">{{ element.Location }}</td>
      </ng-container>

      <!-- DOI Column -->
      <ng-container matColumnDef="doi">
        <th mat-header-cell *matHeaderCellDef>Reference</th>
        <td mat-cell *matCellDef="let element">
          <button class="button-style" (click)="openLink(element.DOI)">
            DOI
          </button>
        </td>
      </ng-container>

      <!-- Link Column -->
      <ng-container matColumnDef="link">
        <th mat-header-cell *matHeaderCellDef>Data Access</th>
        <td mat-cell *matCellDef="let element">
          @if (element.Link === 'Shared by consortium') {
          {{ element.Link }}
          } @else { @if (element.Link) {
          <button class="button-style" (click)="openLink(element.Link)">
            Apply
          </button>
          } }
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
  </div>
</div>
